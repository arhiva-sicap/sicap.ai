# Migration `20200828135257`

This migration has been generated by ciocan at 8/28/2020, 2:52:57 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Db" AS ENUM ('licitatii', 'achizitii');

CREATE TABLE "public"."User" (
"id" text  NOT NULL ,
"hashId" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Bookmark" (
"userId" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"db" "Db" NOT NULL DEFAULT E'licitatii',
"contractId" integer  NOT NULL ,
PRIMARY KEY ("userId","contractId","db"))

CREATE TABLE "public"."Report" (
"id" text  NOT NULL ,
"userId" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"db" "Db" NOT NULL DEFAULT E'licitatii',
"contractId" integer  NOT NULL ,
"confidence" integer  NOT NULL ,
"comment" text  NOT NULL ,
PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "User.hashId_unique" ON "public"."User"("hashId")

CREATE  INDEX "User.hashId_index" ON "public"."User"("hashId")

CREATE UNIQUE INDEX "Bookmark.userId_contractId_db_unique" ON "public"."Bookmark"("userId","contractId","db")

CREATE  INDEX "Bookmark.contractId_index" ON "public"."Bookmark"("contractId")

CREATE  INDEX "Bookmark.userId_index" ON "public"."Bookmark"("userId")

CREATE  INDEX "Bookmark.db_index" ON "public"."Bookmark"("db")

CREATE  INDEX "Report.id_userId_contractId_index" ON "public"."Report"("id","userId","contractId")

ALTER TABLE "public"."Bookmark" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Report" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200828135257
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,48 @@
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id            String      @id @default(cuid())
+  hashId        String      @unique
+  createdAt     DateTime    @default(now())
+  updatedAt     DateTime    @updatedAt
+  bookmarks     Bookmark[]  @relation("UserBookmarks")
+  reports       Report[]    @relation("UserReports")
+  @@index([hashId])
+}
+
+model Bookmark {
+  userId        String
+  User          User        @relation("UserBookmarks", fields: [userId], references: [id])
+  createdAt     DateTime    @default(now())
+  db            Db          @default(licitatii)
+  contractId    Int         
+  @@id([userId, contractId, db])
+  @@unique([userId, contractId, db])
+  @@index([contractId])
+  @@index([userId])
+  @@index([db])
+}
+
+model Report {
+  id            String      @id @default(cuid())
+  userId        String
+  createdAt     DateTime    @default(now())
+  User          User        @relation("UserReports", fields: [userId], references: [id])
+  db            Db          @default(licitatii)
+  contractId    Int         
+  confidence    Int
+  comment       String
+  @@index([id, userId, contractId])
+}
+
+enum Db {
+  licitatii
+  achizitii
+}
```


